import scanner
import requests
import token_finder


target_url = 'http://vulnerable.ddns.net/DVWA/'
# target_url = 'http://ec2-35-174-211-112.compute-1.amazonaws.com/DVWA/login.php'
links_to_ignore = ['http://google.com/logout']

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
forms = vuln_scanner.extract_forms(target_url)
# print(forms)
token = token_finder.CsrfToken(forms)
dict_data = {"username": "admin", "password": "password", str(token.name): str(token.value)}
resp = vuln_scanner.session.post(target_url, data=dict_data)
print(resp)

vuln_scanner.crawl(target_url)

